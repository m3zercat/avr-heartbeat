/*
 * Heartbeat. Yay
 */
#include "heartbeat.h"


/*********************************************************************************************************
 ** Function name:           ...
 ** Descriptions:            ...
 *********************************************************************************************************/
Heartbeat::Heartbeat(int _pin)
{
    this->SetPin(_pin);
}

/*********************************************************************************************************
 ** Function name:           ...
 ** Descriptions:            ...
 *********************************************************************************************************/
Heartbeat::Heartbeat(int _pin, int _gap, int _duration)
{
    this->SetGap(_gap);
    this->SetDuration(_duration);
    this->SetPin(_pin);
}

/*********************************************************************************************************
 ** Function name:           ...
 ** Descriptions:            ...
 *********************************************************************************************************/
void Heartbeat::SetGap(int _gap)
{
    this->gap = _gap;
}

/*********************************************************************************************************
 ** Function name:           ...
 ** Descriptions:            ...
 *********************************************************************************************************/
void Heartbeat::SetDuration(int _duration)
{
    this->duration = _duration;
}

/*********************************************************************************************************
 ** Function name:           ...
 ** Descriptions:            ...
 *********************************************************************************************************/
void Heartbeat::SetPin(int _pin)
{
    this->pin = _pin;
}

/*********************************************************************************************************
 ** Function name:           ...
 ** Descriptions:            ...
 *********************************************************************************************************/
void Heartbeat::Pulse()
{
    unsigned long now = millis();
    if(this->nextMillis < now)
    {
        if(this->state)
        {
            digitalWrite(this->pin, HIGH);
            this->nextMillis = now + this->duration;
            this->state = false;
        }
        else
        {
            digitalWrite(this->pin, LOW);
            this->nextMillis = now + this->gap;
            this->state = true;
        }
    }
}

/*********************************************************************************************************
 * END FILE
 *********************************************************************************************************/